{% extends "layouts/base.html" %}
{% load static %}
{% load table %}
{% load crispy_forms_tags %}

{% block content %}

<!-- Begin Page Content -->
<div class="container-fluid">

    <!-- Page Heading -->
    <h1 class="h3 mb-2 text-gray-800">{{title}}</h1>

    <!-- DataTales Example -->
    <div class="card shadow mb-4">
        <div class="card-header py-3">
            <h6 class="m-0 font-weight-bold text-primary">Build information</h6>
        </div>
        <div class="card-body">
            <div class="row no-gutters align-items-center">
                <div class="col mr-2">
                    <div class="text-xs font-weight-bold text-primary text-uppercase mb-1">
                        ID</div>
                    <div class="h5 mb-0 font-weight-bold text-gray-800">{{object.pk}}</div>
                </div>
                <div class="col mr-2">
                    <div class="text-xs font-weight-bold text-primary text-uppercase mb-1">
                        Name</div>
                    <div class="h5 mb-0 font-weight-bold text-gray-800">{{object.request.name}}</div>
                </div>
                <div class="col mr-2">
                    <div class="text-xs font-weight-bold text-primary text-uppercase mb-1">
                        Request</div>
                    <div class="h5 mb-0 font-weight-bold text-gray-800">{{object.request}}</div>
                </div>
                <div class="col mr-2">
                    <div class="text-xs font-weight-bold text-primary text-uppercase mb-1">
                        Flow</div>
                    <div class="h5 mb-0 font-weight-bold text-gray-800">{{object.flow}}</div>
                </div>
            </div>
            
        </div>
    </div>

    <div class="card shadow mb-4">
        <div class="card-header py-3">
            <h6 class="m-0 font-weight-bold text-primary">Tasks info</h6>
        </div>
        <div class="card-body">
    

            <div class="row no-gutters align-items-center">
                {% for task in object.tasks.all %}
                    <div class="col-12">
                        <div class="text-xs font-weight-bold text-primary text-uppercase mb-1">
                            Task #{{task.order}}</div>
                    </div>
                    <div class="col-12">
                        <code class="text-xs">{{task.logs|linebreaks}}</code>
                    </div>
                    {% empty %}
                    <p>No task executed</p>
                {% endfor %}
            </div>
    
        </div>
    </div>


    <div class="card shadow mb-4">
        <div class="card-header py-3">
            <h6 class="m-0 font-weight-bold text-primary">Celery info</h6>
        </div>
        <div class="card-body">
            <div class="row no-gutters align-items-center">
                <div class="col mr-2">
                    <div class="text-xs font-weight-bold text-primary text-uppercase mb-1">
                        ID</div>
                    <div class="h5 mb-0 font-weight-bold text-gray-800">{{object.celery_task.task_id}}</div>
                </div>
                <div class="col mr-2">
                    <div class="text-xs font-weight-bold text-primary text-uppercase mb-1">
                        Status</div>
                    <div class="h5 mb-0 font-weight-bold text-gray-800">{{object.celery_task.status}}</div>
                </div>
            </div>

            <div class="row no-gutters align-items-center mt-5">
                <p class="text-xs font-weight-bold text-primary text-uppercase mb-1">Traceback</p>
            </div>
            <div class="row no-gutters align-items-center">
                <code class="text-xs">{{object.celery_task.traceback|linebreaks}}</code>
            </div>
    
        </div>
    </div>

</div>


{% endblock content %}