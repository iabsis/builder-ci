{% extends "table.html" %}
{% load build %}
{% load humanize %}

{% block thead %}
    <tr>
        <th>Id</th>
        <th>Name</th>
        <th>URL</th>
        <th>Branch</th>
        <th>Modes</th>
        <th>Build count</th>
        <th>Created at</th>
        <th>Updated at</th>
        <th></th>
    </tr>
{% endblock thead %}
{% block tbody %}
    {% for obj in object_list %}
    <tr>
        
        <td>{{ obj.pk }}</td>
        <td>{{ obj.name }}</td>
        <td>{{ obj.url }}</td>
        <td>{{ obj.branch }}<br>{% if obj.is_tag %}(tag){% else %}(branch){% endif %}</td>
        <td>{{ obj.modes|view_field|safe }}</td>
        <td>
            <a href="{% url 'build' %}?request={{obj.pk}}">
                {{ obj.build_set.count }}
            </a>
        </td>
        <td>{{ obj.created_at|naturaltime }}</td>
        <td>{{ obj.updated_at|naturaltime }}</td>
        <td>
            {% include 'includes/actions.html' %}
            <a href="{% url 'buildrequest_trigger' obj.pk %}" class="btn btn-success btn-icon-split">
                <span class="icon text-white-50">
                    <i class="fas fa-play"></i>
                </span>
                <span class="text">
                    Trigger build
                </span>
            </a>
        </td>
    </tr>
    {% endfor %}
{% endblock tbody %}